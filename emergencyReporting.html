<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Emergency Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
    /* ================= RESET & VARIABLES ================= */
    * { box-sizing: border-box; font-family: 'Poppins', sans-serif; margin: 0; padding: 0; }
    
    :root {
      --brand-dark: #06402B;
      --brand-primary: #059669;
      --brand-hover: #047857;
      --bg-start: #06402B;
      --bg-end: #4d8f73;
      --error-red: #ef4444;
      --glass-white: rgba(255, 255, 255, 0.95);
    }

    body {
      background: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%);
      color: var(--brand-dark);
      min-height: 100vh;
      padding: 20px;
    }

    /* ================= LOCATION BUTTON ================= */
    .location {
      width: 100%;
      max-width: 600px;
      display: block;
      margin: 0 auto 20px auto;
      padding: 16px;
      background: var(--brand-primary);
      color: #fff;
      border: none;
      border-radius: 20px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    .location:hover { background: var(--brand-hover); transform: translateY(-2px); }

    #status, #address { 
      text-align: center;
      color: white; 
      font-size: 13px; 
      margin-top: -10px;
      margin-bottom: 20px;
      font-weight: 500;
    }
    #address a { color: #6ee7b7; font-weight: 700; text-decoration: none; border-bottom: 1px solid; }

    /* ================= QUICK ASSESSMENT CARD ================= */
    .quick { 
      width: 100%; 
      max-width: 600px; 
      padding: 25px; 
      background: var(--glass-white); 
      border-radius: 28px; 
      box-shadow: 0 15px 35px rgba(0,0,0,0.2); 
      margin: 0 auto 40px auto; 
      text-align: left;
    }

    .quick h2 { font-size: 22px; margin-bottom: 8px; color: var(--brand-dark); font-weight: 800; }
    .quick p { margin-bottom: 25px; color: #64748b; font-size: 14px; line-height: 1.4; }

    .quick .question { 
      margin-bottom: 20px; 
      padding: 18px; 
      border-radius: 20px; 
      background-color: #f8fafc; 
      border: 1px solid #e2e8f0;
    }

    .quick .question label { display: block; font-weight: 700; margin-bottom: 12px; color: var(--brand-dark); font-size: 14px; }

    /* Inputs, Selects & Files */
    .quick input[type="text"], .quick select, .quick input[type="file"] { 
      width: 100%; 
      padding: 12px; 
      border-radius: 12px; 
      border: 1.5px solid #d1d5db; 
      font-size: 14px; 
      outline: none;
      background: white;
      margin-bottom: 0; /* Reset original margin */
    }

    /* Options Styling */
    .quick .options label { 
      display: flex; 
      align-items: center; 
      margin-bottom: 10px; 
      font-weight: 500; 
      cursor: pointer; 
      padding: 12px; 
      border-radius: 12px; 
      background: white;
      border: 1px solid #e5e7eb;
      transition: 0.2s;
      font-size: 14px;
      color: var(--brand-dark);
    }
    .quick .options label:hover { background: #f0fdf4; border-color: var(--brand-primary); }
    .quick .options input[type="radio"], .quick .options input[type="checkbox"] { 
        margin-right: 12px; 
        transform: scale(1.2); 
        accent-color: var(--brand-primary); 
    }

    /* ================= SUBMIT BUTTON ================= */
    .quick button.submit { 
      width: 100%; 
      padding: 18px; 
      background: var(--error-red); 
      color: #fff; 
      border: none; 
      border-radius: 20px; 
      font-size: 18px; 
      font-weight: 800; 
      cursor: pointer; 
      transition: 0.3s; 
      box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
      margin-top: 10px;
    }
    .quick button.submit:hover { background: #dc2626; transform: translateY(-3px); box-shadow: 0 12px 25px rgba(239, 68, 68, 0.4); }
</style>
</head>
<body>

<button class="location" id="shareLocationBtn" onclick="shareLocation()">üìç Share Location</button>
<p id="status"></p>
<p id="address"></p>

<div class="quick">
  <h2>üö® Quick Accident Assessment</h2>
  <p>Please answer quickly to help emergency services</p>

  <div class="question">
    <label>1. What happened?</label>
    <div class="options">
      <label><input type="radio" name="incident"> Road Accident</label>
      <label><input type="radio" name="incident"> Pedestrian Accident</label>
      <label><input type="radio" name="incident"> Vehicle Collision</label>
      <label><input type="radio" name="incident"> Medical Emergency</label>
    </div>
  </div>

  <div class="question">
    <label>2. You are?</label>
    <div class="options">
      <label><input type="radio" name="role"> I am injured</label>
      <label><input type="radio" name="role"> Witness</label>
      <label><input type="radio" name="role"> Helping someone</label>
    </div>
  </div>

  <div class="question">
    <label>3. Severity level</label>
    <select>
      <option>Critical (unconscious / heavy bleeding)</option>
      <option>Serious (injured but conscious)</option>
      <option>Minor injury</option>
    </select>
  </div>

  <div class="question">
    <label>4. Is anyone unconscious?</label>
    <div class="options">
      <label><input type="radio" name="unconscious"> Yes</label>
      <label><input type="radio" name="unconscious"> No</label>
      <label><input type="radio" name="unconscious"> Not sure</label>
    </div>
  </div>

  <div class="question">
    <label>5. Number of injured people</label>
    <select>
      <option>1</option>
      <option>2‚Äì3</option>
      <option>More than 3</option>
    </select>
  </div>

  <div class="question">
    <label>6. Victim type</label>
    <div class="options">
      <label><input type="checkbox"> Driver</label>
      <label><input type="checkbox"> Passenger</label>
      <label><input type="checkbox"> Pedestrian</label>
      <label><input type="checkbox"> Cyclist</label>
    </div>
  </div>

  <div class="question">
    <label>7. Accident location</label>
    <input type="text" placeholder="Auto-detected GPS location">
  </div>

  <div class="question">
    <label>8. Any immediate danger?</label>
    <div class="options">
      <label><input type="checkbox"> Fire</label>
      <label><input type="checkbox"> Fuel leakage</label>
      <label><input type="checkbox"> Heavy traffic</label>
      <label><input type="checkbox"> No immediate danger</label>
    </div>
  </div>

  <div class="question">
    <label>9. Upload photo (optional)</label>
    <input type="file">
  </div>

  <div class="question">
    <label>10. Can we contact you?</label>
    <div class="options">
      <label><input type="radio" name="contact"> Yes</label>
      <label><input type="radio" name="contact"> No</label>
    </div>
  </div>

  <button class="submit" id="submitReport">üöë Submit Emergency Report</button>
</div>

<script>
function shareLocation() {
    const status = document.getElementById("status");
    const address = document.getElementById("address");
    if (!navigator.geolocation) { status.textContent = "Geolocation not supported"; return; }
    status.textContent = "Locating‚Ä¶";
    navigator.geolocation.getCurrentPosition((pos) => {
        const lat = pos.coords.latitude.toFixed(6);
        const lng = pos.coords.longitude.toFixed(6);
        status.textContent = "Location found!";
        address.innerHTML = `Latitude: ${lat} <br>Longitude: ${lng} <br><a href="https://www.google.com/maps?q=${lat},${lng}" target="_blank">View on Google Maps</a>`;
        document.querySelector('input[placeholder="Auto-detected GPS location"]').value = `${lat}, ${lng}`;
    }, (err) => { status.textContent = "Unable to fetch location"; });
}

document.getElementById("submitReport").addEventListener("click", async function(e){
    e.preventDefault();
    const name = prompt("Enter your name") || "Anonymous";
    const incident = document.querySelector('input[name="incident"]:checked')?.parentElement.textContent.trim() || "Unknown";
    const role = document.querySelector('input[name="role"]:checked')?.parentElement.textContent.trim() || "Unknown";
    const severity = document.querySelectorAll('select')[0].value;
    const unconscious = document.querySelector('input[name="unconscious"]:checked')?.parentElement.textContent.trim() || "Unknown";
    const numberInjured = document.querySelectorAll('select')[1].value;
    const victimTypes = Array.from(document.querySelectorAll('div.question:nth-child(6) input[type="checkbox"]:checked')).map(cb => cb.parentElement.textContent.trim());
    const immediateDanger = Array.from(document.querySelectorAll('div.question:nth-child(8) input[type="checkbox"]:checked')).map(cb => cb.parentElement.textContent.trim());
    const locationInput = document.querySelector('input[placeholder="Auto-detected GPS location"]').value;
    const citizenData = { name, incident, role, severity, unconscious, numberInjured, victimTypes, immediateDanger, locationInput };
    try {
        const response = await fetch('http://localhost:5000/api/emergencies', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(citizenData)
        });
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const data = await response.json();
        alert("‚úÖ Emergency reported successfully!");
        console.log(data);
    } catch (err) {
        alert("‚ùå Failed to send report");
        console.error(err);
    }
});
</script>
</body>
</html>
